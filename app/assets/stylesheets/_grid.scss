$sizes: (
  small: (false, $small-only),
  medium: ($medium-only, $medium-up),
  large: ($large-only, $large-up),
  extra-large: ($extra-large-only, $extra-large-up)
);

@mixin columns($size, $amount: $column-count) {
  @for $i from 1 through $amount {
    &.#{$size}-#{$i} {
      width: percentage($i/$amount);
    }
  }
}

.row {
  @include clearfix;
  max-width: $grid-width + $grid-spacing;
  margin: 0 auto;

  .row & {
    margin: 0 -$grid-spacing/2;
    max-width: $grid-width;
  }
}

.column,
.columns {
  float: left;
  padding: 0 $grid-spacing/2;
  width: 100%;

  @include columns(small);

  @each $size, $queries in $sizes {
    @if (nth($queries, 1) != false) {
      @media #{nth($queries, 1)} {
        @include columns(unquote("#{$size}-only"));
      }
    }

    @if (nth($queries, 2) != false) {
      @media #{nth($queries, 2)} {
        @include columns($size) ;
      }
    }
  }
}
